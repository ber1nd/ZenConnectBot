<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zen Warrior Character Sheet</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- The rest of your existing <style> section remains unchanged -->
</head>
<body>
    <!-- The entire <div class="character-sheet"> section remains unchanged -->

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // Function to get URL parameters
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        const userId = getUrlParameter('user_id');

        async function fetchStats() {
            try {
                console.log("Fetching stats for user ID:", userId);
                const response = await fetch(`https://zenconnectbot-production.up.railway.app/api/stats?user_id=${userId}`);
                console.log("Response status:", response.status);
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Failed to fetch stats: ${response.status} ${errorText}`);
                }
                const stats = await response.json();
                console.log("Received stats:", stats);
                updateCharacterSheet(stats);
            } catch (error) {
                console.error('Error fetching stats:', error);
                document.getElementById('error-message').textContent = `Error: ${error.message}`;
            }
}

        // The updateCharacterSheet function remains unchanged

        fetchStats();
    </script>
</body>
</html>